(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{592:function(t,e,r){"use strict";r.r(e);var o=r(45),a=Object(o.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"生命周期"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#生命周期"}},[t._v("#")]),t._v(" 生命周期")]),t._v(" "),r("p",[t._v("初始化阶段")]),t._v(" "),r("ul",[r("li",[r("h5",{attrs:{id:"constructor-构造函数"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#constructor-构造函数"}},[t._v("#")]),t._v(" "),r("code",[t._v("constructor")]),t._v(" 构造函数")]),t._v(" "),r("p",[t._v("需要在 constructor 中 super(props)")]),t._v(" "),r("p",[t._v("需要将函数绑定this")])]),t._v(" "),r("li",[r("h5",{attrs:{id:"getdefaultprops-props默认值"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#getdefaultprops-props默认值"}},[t._v("#")]),t._v(" "),r("code",[t._v("getDefaultProps")]),t._v(" "),r("code",[t._v("props")]),t._v("默认值")])]),t._v(" "),r("li",[r("h5",{attrs:{id:"getinitialstate-state默认值"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#getinitialstate-state默认值"}},[t._v("#")]),t._v(" "),r("code",[t._v("getInitialState")]),t._v(" "),r("code",[t._v("state")]),t._v("默认值")])])]),t._v(" "),r("p",[t._v("挂载阶段")]),t._v(" "),r("ul",[r("li",[r("h5",{attrs:{id:"static-getderivedstatefromprops-props-state"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#static-getderivedstatefromprops-props-state"}},[t._v("#")]),t._v(" "),r("code",[t._v("static getDerivedStateFromProps(props, state)")])]),t._v(" "),r("ul",[r("li",[t._v("会在调用 render 方法之前调用，并且在初始挂载及后续更新时都会被调用")]),t._v(" "),r("li",[t._v("state 的值在任何时候都取决于 props 才使用这个生命周期")]),t._v(" "),r("li",[t._v("派生状态会导致代码冗余，并使组件难以维护。 "),r("a",{attrs:{href:"https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("确保你已熟悉这些简单的替代方案："),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[t._v("如果你需要"),r("strong",[t._v("执行副作用")]),t._v("（例如，数据提取或动画）以响应 props 中的更改，请改用 "),r("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/react-component.html#componentdidupdate",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("componentDidUpdate")]),r("OutboundLink")],1),t._v("。")]),t._v(" "),r("li",[t._v("如果只想在 "),r("strong",[t._v("prop 更改时重新计算某些数据")]),t._v("，"),r("a",{attrs:{href:"https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization",target:"_blank",rel:"noopener noreferrer"}},[t._v("请使用 memoization helper 代替"),r("OutboundLink")],1),t._v("。")]),t._v(" "),r("li",[t._v("如果你想"),r("strong",[t._v("在 prop 更改时“重置”某些 state")]),t._v("，请考虑使组件"),r("a",{attrs:{href:"https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-controlled-component",target:"_blank",rel:"noopener noreferrer"}},[t._v("完全受控"),r("OutboundLink")],1),t._v("或"),r("a",{attrs:{href:"https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-uncontrolled-component-with-a-key",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 "),r("code",[t._v("key")]),t._v(" 使组件完全不受控"),r("OutboundLink")],1),t._v(" 代替。")])])]),t._v(" "),r("li",[t._v("不管原因是什么，都会在"),r("strong",[t._v("每次")]),t._v("渲染前触发此方法\n这与 "),r("code",[t._v("UNSAFE_componentWillReceiveProps")]),t._v(" 形成对比，后者仅在父组件重新渲染时触发，而不是在内部调用 "),r("code",[t._v("setState")]),t._v(" 时")])])]),t._v(" "),r("li",[r("h5",{attrs:{id:"render"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#render"}},[t._v("#")]),t._v(" "),r("code",[t._v("render()")])]),t._v(" "),r("p",[t._v("Render 可能会返回的类型有：")]),t._v(" "),r("ul",[r("li",[r("p",[r("strong",[t._v("React 元素")]),t._v("：通常通过 JSX 创建")])]),t._v(" "),r("li",[r("p",[r("strong",[t._v("数组或 fragments")]),t._v("：使 render 可以返回多个元素，或者用 React.Fragment 包裹")])]),t._v(" "),r("li",[r("p",[r("strong",[t._v("Portals")]),t._v("：ReactDOM.createPortal(child, container)")]),t._v(" "),r("blockquote",[r("p",[t._v("https://zh-hans.reactjs.org/docs/portals.html")])])]),t._v(" "),r("li",[r("p",[r("strong",[t._v("字符串或者数值")]),t._v("：表示为文本节点")])]),t._v(" "),r("li",[r("p",[r("strong",[t._v("布尔类型或 "),r("code",[t._v("null")])]),t._v("：什么都不渲染，主要用于支持返回 "),r("code",[t._v("test && <Child />")]),t._v(" 的模式")])])]),t._v(" "),r("p",[r("code",[t._v("render()")]),t._v(" 函数应该为纯函数")])]),t._v(" "),r("li",[r("h5",{attrs:{id:"componentdidmount"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#componentdidmount"}},[t._v("#")]),t._v(" "),r("code",[t._v("componentDidMount")])]),t._v(" "),r("ul",[r("li",[t._v("在组件挂载后（插入 DOM 树中）立即调用")]),t._v(" "),r("li",[t._v("比较适合添加订阅的地方。如果添加了订阅，不要忘记在 "),r("code",[t._v("componentWillUnmount()")]),t._v(" 里取消订阅")]),t._v(" "),r("li",[t._v("可以直接调用 setState，但是将触发额外的 render，但是浏览器只重新渲染一次")])])])]),t._v(" "),r("p",[t._v("更新阶段")]),t._v(" "),r("ul",[r("li",[r("h5",{attrs:{id:"static-getderivedstatefromprops-props-state-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#static-getderivedstatefromprops-props-state-2"}},[t._v("#")]),t._v(" "),r("code",[t._v("static getDerivedStateFromProps(props, state)")])])]),t._v(" "),r("li",[r("h5",{attrs:{id:"shouldcomponentupdate"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#shouldcomponentupdate"}},[t._v("#")]),t._v(" "),r("code",[t._v("shouldComponentUpdate")]),t._v(" ：")]),t._v(" "),r("ul",[r("li",[t._v("根据返回值决定是否更新组件，默认 return true，行为是 state 每次发生变化组件都会重新渲染")]),t._v(" "),r("li",[t._v("首次渲染或使用 "),r("code",[t._v("forceUpdate()")]),t._v(" 时不会调用该方法")]),t._v(" "),r("li",[t._v("只是作为性能优化而存在，应首先考虑 PureComponent")]),t._v(" "),r("li",[t._v("不建议在 "),r("code",[t._v("shouldComponentUpdate()")]),t._v(" 中进行深层比较或使用 "),r("code",[t._v("JSON.stringify()")]),t._v("。这样非常影响效率，且会损害性能")])])]),t._v(" "),r("li",[r("h5",{attrs:{id:"componentwillupdate"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#componentwillupdate"}},[t._v("#")]),t._v(" "),r("code",[t._v("componentWillUpdate")])])]),t._v(" "),r("li",[r("h5",{attrs:{id:"render-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#render-2"}},[t._v("#")]),t._v(" "),r("code",[t._v("render")])])]),t._v(" "),r("li",[r("h5",{attrs:{id:"getsnapshotbeforeupdate-prevprops-prevstate"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#getsnapshotbeforeupdate-prevprops-prevstate"}},[t._v("#")]),t._v(" "),r("code",[t._v("getSnapshotBeforeUpdate(prevProps, prevState)")])]),t._v(" "),r("ul",[r("li",[t._v("在最近一次渲染输出（提交到 DOM 节点）之前调用")]),t._v(" "),r("li",[t._v("它使得组件能在发生更改之前从 DOM 中捕获一些信息（例如，滚动位置）")]),t._v(" "),r("li",[t._v("此生命周期的任何返回值将作为参数传递给 "),r("code",[t._v("componentDidUpdate()")])])])]),t._v(" "),r("li",[r("h5",{attrs:{id:"componentdidupdate-prevprops-prevstate-snap"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#componentdidupdate-prevprops-prevstate-snap"}},[t._v("#")]),t._v(" "),r("code",[t._v("componentDidUpdate(prevProps, prevState, snap)")])]),t._v(" "),r("ul",[r("li",[t._v("更新后会被立即调用")]),t._v(" "),r("li",[t._v("首次渲染不会执行此方法")]),t._v(" "),r("li",[t._v("当组件更新后，可以在此处对 DOM 进行操作。如果你对更新前后的 props 进行了比较，也可以选择在此处进行网络请求")]),t._v(" "),r("li",[t._v("可以"),r("strong",[t._v("直接调用 "),r("code",[t._v("setState()")])]),t._v("，"),r("strong",[t._v("必须被包裹在一个条件语句里")]),t._v("，否则会导致死循环")])])])]),t._v(" "),r("p",[t._v("卸载阶段")]),t._v(" "),r("ul",[r("li",[r("h5",{attrs:{id:"componentwillunmount-组件卸载前调用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#componentwillunmount-组件卸载前调用"}},[t._v("#")]),t._v(" "),r("code",[t._v("componentWillUnmount")]),t._v(" 组件卸载前调用")])])])])}),[],!1,null,null,null);e.default=a.exports}}]);