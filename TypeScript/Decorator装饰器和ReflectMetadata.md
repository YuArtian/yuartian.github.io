# Decorators

> TS系列篇｜装饰器(@)
>
> https://juejin.cn/post/7006483808832716813

> https://www.tslang.cn/docs/handbook/decorators.html

装饰器是一种特殊类型的声明，它能够被附加到`类声明`、`方法`、`属性`或者`参数`上

使用 @ 语法，实现为一个函数，在运行时被调用

需要 tsconfig 设置 experimentalDecorators 为 true

常见的装饰器有: `类装饰器`、`属性装饰器`、`方法装饰器`、`参数装饰器`

可以使用柯里化实现工厂装饰器，好处是允许传参数

## Reflect Metadata

> GPT

`Reflect Metadata` 是一个用于在 JavaScript 对象上定义和查询元数据的库

它通常与 TypeScript 的装饰器一起使用，以实现更加复杂和灵活的元编程功能。`Reflect Metadata` 库提供了一组工具，允许你在对象上添加元数据，并在运行时查询这些元数据

`Reflect Metadata` 是一个强大的工具，尤其在 TypeScript 中结合装饰器使用时，可以实现高级元编程功能。通过 `Reflect Metadata`，你可以在对象上定义和查询元数据，实现如依赖注入、验证等复杂功能，使代码更具扩展性和灵活性



## 装饰器语法编译成js时是什么样的？

当 TypeScript 装饰器编译成 JavaScript 时，装饰器被转换为普通的函数调用，并且由 __decorate 辅助函数处理

这使得装饰器在编译后的 JavaScript 代码中表现为对目标类或类成员的一系列函数调用，从而实现原始 TypeScript 装饰器的功能



## 装饰器的执行顺序

在TypeScript里，当多个装饰器应用在一个声明上时会进行如下步骤的操作：

1. 由上至下依次对装饰器表达式求值。
2. 求值的结果会被当作函数，由下至上依次调用。

洋葱模型

## 装饰器求值顺序

类中不同声明上的装饰器将按以下规定的顺序应用：

1. *参数装饰器*，然后依次是*方法装饰器*，*访问符装饰器*，或*属性装饰器*应用到每个实例成员。
2. *参数装饰器*，然后依次是*方法装饰器*，*访问符装饰器*，或*属性装饰器*应用到每个静态成员。
3. *参数装饰器*应用到构造函数。
4. *类装饰器*应用到类。

